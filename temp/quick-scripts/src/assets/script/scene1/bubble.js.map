{"version":3,"sources":["assets\\script\\scene1\\bubble.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property\r\n    bubble_type:number = 0;\r\n\r\n    isclick:boolean = false; //气泡只能点击一次\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    //点击气泡后的提示\r\n\r\n        /**\r\n\t * 生成范围随机数\r\n\t * @Min 最小值\r\n\t * @Max 最大值\r\n\t */\r\n\tpublic GetRandomNum(Min, Max):number {\r\n\t\tvar Range = Max - Min;\r\n\t\tvar Rand = Math.random();\r\n\t\treturn (Min + Math.round(Rand * Range));\r\n\t}\r\n\r\n\r\n    bubble_ui(ui_name:string){\r\n        \r\n        \r\n        let bubble_touch = new cc.Node();\r\n        var tishi = bubble_touch.addComponent(cc.Label); //增加label组件并赋给丹药数量\r\n        if(this.bubble_type == 0){\r\n            bubble_touch.color = cc.color(0,0,0); //将字体改为白色\r\n        }\r\n        else if(this.bubble_type == 1){\r\n            bubble_touch.color = cc.color(147,9,247); //将字体改为橙色\r\n        }\r\n        else if(this.bubble_type == 2){\r\n            bubble_touch.color = cc.color(234,139,28); //将字体改为橙色\r\n        }\r\n        else if(this.bubble_type == 3){\r\n            bubble_touch.color = cc.color(39,103,208); //将字体改为蓝色\r\n        }\r\n        else if(this.bubble_type == 4){\r\n            bubble_touch.color = cc.color(247,233,10); //将字体改为黄色\r\n        }\r\n        else {\r\n            bubble_touch.color = cc.color(241,19,23); //将字体改为红色\r\n        }\r\n\r\n\r\n        //设置文本大小\r\n        tishi.fontSize = 30;\r\n        tishi.lineHeight = 30;\r\n     \r\n        bubble_touch.setParent(this.node);  //父节点是this.node才能出来\r\n        bubble_touch.x = 0; //相对于父节点的横坐标位置不变\r\n        bubble_touch.y = 60;//相对于父节点的纵坐标在下面一点的位置\r\n        tishi.string = ui_name;  \r\n    \r\n    \r\n        //延时最后的时间为ms,延时1秒销毁，如果在上面的schedule函数还没执行完就销毁，会报错\r\n        setTimeout(()=>{\r\n            bubble_touch.destroy();\r\n        }, 800);\r\n            \r\n    }\r\n\r\n\r\n    bubble_effect(){\r\n\r\n        let persist = cc.find('persist_node').getComponent('persist_node'); //获取常驻节点\r\n\r\n        switch (this.bubble_type) {\r\n            case 0:\r\n                this.bubble_ui(\"无事发生\");\r\n\r\n                break;\r\n            \r\n            case 1:\r\n                //点击增加精力值\r\n                persist.changeEnergy(Math.abs(persist.max_energy())/10);//一个气泡恢复2%的精力条\r\n                this.bubble_ui(\"精力增长~\");\r\n\r\n                break;\r\n\r\n            case 2:\r\n                let jingyan = this.GetRandomNum(5,20); //随机提升一部分比例经验\r\n                persist.exp_gain(persist.exp_required()/jingyan);\r\n                this.bubble_ui(\"经验增长~\");\r\n\r\n                break;\r\n            \r\n            case 3:\r\n                let att_id = this.GetRandomNum(0,8); //随机提升某一项属性\r\n                let att_name = persist.attribute_name[att_id];  //获得相应的属性名称\r\n                persist.change_attr(att_name, 50); //改变对应的属性，增加一点\r\n\r\n                this.bubble_ui(att_name+\"+50\");\r\n\r\n                break;\r\n            \r\n            case 4:\r\n                let item = this.GetRandomNum(0,7); //随机获取一个物品\r\n                persist.setitem(item,1);\r\n                this.bubble_ui(\"+1\");\r\n\r\n                break;\r\n            \r\n            case 5:\r\n                //红色气泡惩罚(不会掉落物品)\r\n                let x = this.GetRandomNum(0,2); //控制随机试取疲劳值还是经验值或是属性,会出现0,1,2随机数\r\n\r\n                if(x==0){\r\n                    persist.changeEnergy(-1*persist.max_energy()/10);//一个气泡恢复2%的精力条\r\n                    this.bubble_ui(\"精力降低ono\");\r\n                }\r\n\r\n                else if(x==1){\r\n                    let jingyan = this.GetRandomNum(5,20); //随机提升一部分比例经验\r\n                    persist.exp_gain(-1*persist.exp_required()/jingyan);\r\n                    this.bubble_ui(\"经验下降ono\");\r\n                }\r\n\r\n                else{\r\n                    let att_id = this.GetRandomNum(0,8); //随机提升某一项属性\r\n                    let att_name = persist.attribute_name[att_id];  //获得相应的属性名\r\n                    if(persist.get_attr(att_name) == 0){\r\n                        persist.change_attr(att_name, 0); //改变对应的属性，增加一点\r\n                        this.bubble_ui(att_name+\"已减为0\");\r\n                    }\r\n                    \r\n                    else{\r\n                        persist.change_attr(att_name, -50); //改变对应的属性，增加一点\r\n                        this.bubble_ui(att_name+\"-50\");\r\n                    }\r\n                }\r\n\r\n                break;\r\n            \r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    start () {\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (event)=>{\r\n            if(this.isclick == false){\r\n\r\n                cc.loader.loadRes(\"气泡\", cc.AudioClip, (res,clip)=>{\r\n                    //播放音乐\r\n                    let audioID: number = cc.audioEngine.playEffect(clip, false);\r\n                    cc.audioEngine.setVolume(audioID, 0.3);\r\n                    //停止播放音乐\r\n                    //cc.audioEngine.stop(audioID);\r\n                });\r\n\r\n                let player = cc.find('player').getComponent('player')  //点击气泡增加人物年龄\r\n                if(player.click_bubble < 4){\r\n                    player.click_bubble += 1;\r\n                }  \r\n                else{\r\n                    player.click_bubble = 0;\r\n                    cc.find('persist_node').getComponent('persist_node').addAge(1);  //点击五次增加一岁\r\n                }\r\n\r\n\r\n                this.bubble_effect();  //触发气泡效果\r\n                this.isclick = true;\r\n\r\n                setTimeout(()=>{\r\n                    this.node.active = false;  //延时500ms消失,用destroy会导致schedule报错\r\n                }, 500);\r\n            }\r\n            \r\n            \r\n        \r\n        });\r\n\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}