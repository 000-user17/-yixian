{"version":3,"sources":["assets\\script\\scene1\\player.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class player extends cc.Component {\r\n\r\n\r\n    @property\r\n    bubble_inteval:number = 0;  //产生气泡的时间间隔\r\n\r\n    @property\r\n    bubble_time:number=0;      //计算气泡产生的时间\r\n\r\n    @property(cc.Prefab)           //存储不同的气泡类型\r\n    bubble_set:cc.Prefab[]=[null];\r\n\r\n    click_bubble:number = 0  //点击气泡的次数，点击五次增加1年寿命\r\n\r\n\r\n    set_bubble_time(){  //设置生成气泡的时间，会随着精力值的下降而上升\r\n        let persist = cc.find('persist_node').getComponent('persist_node');\r\n        let num = persist.getEnergy()/persist.max_energy() + 0.6; //最快也是2秒产生一个气泡\r\n\r\n        this.bubble_inteval = num;\r\n        return this.bubble_inteval;\r\n    }\r\n\r\n\r\n    /**\r\n\t * 生成范围随机数\r\n\t * @Min 最小值\r\n\t * @Max 最大值\r\n\t */\r\n\tpublic GetRandomNum(Min, Max):number {\r\n\t\tvar Range = Max - Min;\r\n\t\tvar Rand = Math.random();\r\n\t\treturn (Min + Math.round(Rand * Range));\r\n\t}\r\n\r\n\r\n    //bubble_id:要产生哪种气泡，0，1，2，3，4，5分别代表，无用气泡，增加精力值气泡，增加经验修为气泡，增加属性气泡，增加物品气泡，心魔气泡\r\n    bubble_loc(bubble_id:number, speed:number, exist_time:number){   //控制气泡产生的随机位置\r\n\r\n        let x_loc = this.GetRandomNum(-400, 700);  //气泡产生的x轴位置，需要结合cocos面板进行调整，生成在人物两端\r\n        //while(x_loc>-40 && x_loc<50){\r\n        //    let x_loc = this.GetRandomNum(-100, 150);\r\n        //}\r\n        let y_loc = this.GetRandomNum(-600, 0);  //气泡产生的y轴位置\r\n\r\n        let bubble = cc.instantiate(this.bubble_set[bubble_id]);\r\n        bubble.setParent(cc.director.getScene()); //把子弹放到当前节点的子节点上\r\n        bubble.x = this.node.x+x_loc;\r\n        bubble.y = this.node.y+y_loc;\r\n\r\n        let x_change = 0\r\n        this.schedule(()=>{\r\n\r\n            if(x_loc < -200){//靠左的时候向右边移动的多\r\n                x_change = this.GetRandomNum(0, 3);\r\n            }\r\n        \r\n            else if(x_loc > 400){//靠左的时候向右边移动的多\r\n                x_change = this.GetRandomNum(-3, 0);\r\n            }\r\n        \r\n            else{\r\n                x_change = this.GetRandomNum(-1, 1);\r\n            }\r\n        \r\n            bubble.x+=x_change;\r\n            bubble.y+=speed;   //气泡上升的速度\r\n            \r\n        }, 0.01, 600);\r\n\r\n        setTimeout(()=>{\r\n            bubble.active = false;  //延时500ms消失,用destroy会导致schedule报错\r\n        }, exist_time);\r\n        \r\n\r\n\r\n    }\r\n\r\n\r\n    bubble_create(min:number, max:number){\r\n        let x = this.GetRandomNum(min,max); //用于计算气泡出现的概率,因为产生的随机数值是离散的，所以需要扩大范围\r\n\r\n        let y = this.GetRandomNum(0,1400); //用于控制产生哪种气泡的概率\r\n\r\n        //获取当前疲劳值所占总疲劳值的比例,目的是让疲劳值越空时，产生越多的气泡\r\n        let persist = cc.find('persist_node').getComponent('persist_node');\r\n        let exau_ratio = persist.getEnergy()/persist.max_energy();//当前疲劳值占比，如果精力值为0，必定会产生气泡\r\n\r\n        if(x>(min-max)*exau_ratio){  //产生气泡\r\n\r\n            if(y<600){   //产生收益气泡\r\n                if(y<300){\r\n                    //产生消除疲劳气泡\r\n                    this.bubble_loc(1,5,4000);\r\n                   \r\n\r\n                }\r\n                else if(y<450 && y>=300){\r\n                    //产生经验值气泡\r\n                    this.bubble_loc(2,7,3000);\r\n                    \r\n                }\r\n                else if(y<550 && y>=450 ){\r\n                    //产生属性气泡\r\n                    this.bubble_loc(3,8,2000);\r\n                    \r\n                }\r\n                else{\r\n                    //产生天才地宝\r\n                    this.bubble_loc(4,10,1000);\r\n                   \r\n                }\r\n            }\r\n            else if(y<900 && y>=600){\r\n                //产生无用气泡\r\n                this.bubble_loc(0,3,6000);\r\n             \r\n            }\r\n            else{\r\n                //产生有害气泡\r\n                this.bubble_loc(5,2,8000);\r\n               \r\n            }\r\n\r\n        }\r\n        \r\n\r\n    }\r\n\r\n\r\n    @property( [cc.SpriteFrame] )\r\n    frames: cc.SpriteFrame[] = [];//或者 frames: cc.SpriteFrame[] = new Array();\r\n    sprite:cc.Sprite=null;\r\n    index:number=1;\r\n    interval:number=0.01;\r\n\r\n  \r\n\r\n    onLoad () {\r\n      this.sprite=this.node.getComponent(cc.Sprite);\r\n    }\r\n\r\n\r\n    onTimer(){\r\n    if(this.frames.length==0)return;\r\n\r\n    this.sprite.spriteFrame =this.frames[this.index];\r\n    this.index++;\r\n    if(this.index >= this.frames.length)//这里不适用取余，数字在不断增大超出表示范围\r\n    this.index = 0;\r\n    }\r\n\r\n\r\n    \r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start () {\r\n\r\n        this.schedule(this.onTimer,this.interval) //动态加载图片\r\n\r\n        cc.find('persist_node').getComponent('persist_node').is_create_bubble = false; //每次返回到主页面时，都会让打坐修行关闭，从而不产生气泡\r\n\r\n        this.set_bubble_time();  //计算新的气泡产生间隔时间\r\n        \r\n        //触摸人物出现人物属性面板\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (event)=>{\r\n    \r\n        \r\n        });\r\n\r\n    }\r\n\r\n    update (dt) {\r\n        let persist = cc.find('persist_node').getComponent('persist_node');\r\n\r\n        if(this.bubble_time < this.bubble_inteval){  \r\n            this.bubble_time+=dt;\r\n        }\r\n\r\n        else{\r\n            this.set_bubble_time();  //在气泡产生完毕后开始重新计算新的气泡产生间隔时间\r\n            this.bubble_time = 0;\r\n\r\n            if(persist.is_create_bubble){   //如果进行打坐修炼\r\n                this.bubble_create(0, 100);        //这里不用schedule函数产生，用update动态生成\r\n            }\r\n\r\n        }\r\n\r\n\r\n    }\r\n}\r\n"]}