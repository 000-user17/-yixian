{"version":3,"sources":["assets\\script\\scene1\\exp.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAE5E,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAiC,uBAAY;IAA7C;QAAA,qEAoHC;QAjHG,aAAO,GAAY,IAAI,CAAC;QAExB,MAAM;QAEN,WAAK,GAAW,CAAC,CAAC;QAElB,SAAS;QAET,aAAO,GAAW,CAAC,CAAC;;IAyGxB,CAAC;IAvGG,wBAAwB;IAExB,sBAAQ,GAAR;QACI,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;QACf,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;IACrB,CAAC;IAED,oBAAoB;IACpB,6BAAe,GAAf;QACI,OAAO,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IACtC,CAAC;IAED,cAAc;IACd,2BAAa,GAAb,UAAc,QAAiB;QAA/B,iBASC;QARI,IAAI,CAAC,KAAK,GAAkB,QAAQ,GAA1B,EAAE,IAAI,CAAC,OAAO,GAAI,QAAQ,GAAZ,CAAa;QAEtC,sBAAsB;QACtB,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAC5C,IAAI,CAAC,QAAQ,CAAC,UAAC,EAAM;YAAN,mBAAA,EAAA,QAAM;YACjB,GAAG,CAAC,SAAS,IAAG,CAAC,CAAC,GAAC,KAAI,CAAC,YAAY,EAAE,CAAC,CAAC,CAAE,qFAAqF;QACnI,CAAC,EAAE,CAAC,GAAC,IAAI,CAAC,YAAY,EAAE,GAAC,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;IAE/C,CAAC;IAED,WAAW;IACX,0BAAY,GAAZ;QACI,OAAO,CAAC,IAAI,CAAC,KAAK,GAAC,CAAC,CAAC,GAAC,GAAG,CAAC,CAAE,cAAc;IAC9C,CAAC;IAED,WAAW;IACX,wBAAU,GAAV,UAAW,OAAc,EAAE,OAAc;QACrC,6CAA6C;QAC7C,IAAG,CAAC,OAAO,GAAC,OAAO,CAAC,IAAI,IAAI,CAAC,YAAY,EAAE,EAAC;YACxC,IAAI,CAAC,OAAO,IAAI,OAAO,CAAC;SAC3B;aACG;YACA,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;SACtC;IAEL,CAAC;IAGD,UAAU;IACV,sBAAQ,GAAR,UAAS,QAAe,EAAE,SAAgB;QAA1C,iBAoBC;QAnBG,UAAU;QACV,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAE5C,iBAAiB;QACjB,QAAQ,QAAQ,EAAE;YACd,KAAK,QAAQ,GAAC,CAAC;gBACX,gBAAgB;gBAChB,IAAI,CAAC,QAAQ,CAAC,UAAC,EAAM;oBAAN,mBAAA,EAAA,QAAM;oBACjB,GAAG,CAAC,SAAS,IAAG,CAAC,CAAC,GAAC,KAAI,CAAC,YAAY,EAAE,CAAC,CAAC,CAAE,qFAAqF;gBACnI,CAAC,EAAE,CAAC,GAAC,IAAI,CAAC,YAAY,EAAE,GAAC,EAAE,EAAE,SAAS,CAAC,CAAC;gBAExC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAE,WAAW;gBAEtD,MAAM;YAEV;gBACI,MAAM;SACb;IAEL,CAAC;IAGD,oBAAM,GAAN;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,cAAc;IAEnC,CAAC;IAGD,mBAAK,GAAL;QAAA,iBAcC;QAZG,0BAA0B;QAC1B,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC,eAAe,EAAE,CAAC,CAAC;QAK3F,iBAAiB;QACjB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,UAAC,KAAK;YAC9C,KAAI,CAAC,QAAQ,CAAC,CAAC,EAAC,GAAG,CAAC,CAAC;QAEzB,CAAC,CAAC,CAAC;IAEP,CAAC;IAEA,oBAAM,GAAN,UAAQ,EAAE;QAIP,kBAAkB;QAClB,IAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,YAAY,EAAE,EAAC;YACnC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAC,IAAI,CAAC;SAE5B;aACG;YACA,IAAI,CAAC,OAAO,CAAC,MAAM,GAAC,KAAK,CAAC;SAC7B;IAGJ,CAAC;IAhHF;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wCACM;IAIxB;QADC,QAAQ;sCACS;IAIlB;QADC,QAAQ;wCACW;IAXH,GAAG;QADvB,OAAO;OACa,GAAG,CAoHvB;IAAD,UAAC;CApHD,AAoHC,CApHgC,EAAE,CAAC,SAAS,GAoH5C;kBApHoB,GAAG","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class exp extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    xiuxian: cc.Node = null;\r\n\r\n    //人物等级\r\n    @property\r\n    level: number = 0;\r\n\r\n    //人物当前经验值\r\n    @property\r\n    exp_now: number = 0;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    exp_init(){\r\n        this.level = 0;\r\n        this.exp_now = 0;\r\n    }\r\n\r\n    //用于自动保存节点获取当前的exp信息\r\n    exp_information(){\r\n        return [this.level, this.exp_now];\r\n    }\r\n\r\n    //获取自动保存的exp信息\r\n    exp_auto_save(autosave:number[]){\r\n        [this.level, this.exp_now] = autosave;\r\n\r\n        //拿到了自动保存的数值，再修改经验值进度条\r\n        let exp = this.node.getComponent(cc.Sprite);\r\n        this.schedule((as=exp)=>{\r\n            exp.fillRange+= (1/this.exp_required());  //经验exp.fillRange到1表示经验满，经验值增长的可视化横条，1/this.exp_required()表示每间隔一定时间增加这么多的经验条显示，实现动态增长\r\n        }, 1/this.exp_required()/25, this.exp_now);\r\n\r\n    }\r\n\r\n    //不同等级的所需经验\r\n    exp_required():number{\r\n        return (this.level+1)*200;  //可以设置其他单调递增函数\r\n    }\r\n\r\n    //判断经验值是否溢出\r\n    exp_filled(exp_now:number, exp_add:number){\r\n        //如果经验值增长超过最大经验值，则设置为当前等级的最大经验值，否则直接相加作为当前经验值\r\n        if((exp_now+exp_add) <= this.exp_required()){\r\n            this.exp_now += exp_add;\r\n        }\r\n        else{\r\n            this.exp_now = this.exp_required();\r\n        }\r\n\r\n    }\r\n\r\n\r\n    //增长经验条的方法\r\n    exp_gain(event_ID:number, event_exp:number){\r\n        //获取到exp属性\r\n        let exp = this.node.getComponent(cc.Sprite);\r\n\r\n        //根据不同的事件获取不同的经验值\r\n        switch (event_ID) {\r\n            case event_ID=0:\r\n                //延时函数让经验条可以连续上涨\r\n                this.schedule((as=exp)=>{\r\n                    exp.fillRange+= (1/this.exp_required());  //经验exp.fillRange到1表示经验满，经验值增长的可视化横条，1/this.exp_required()表示每间隔一定时间增加这么多的经验条显示，实现动态增长\r\n                }, 1/this.exp_required()/25, event_exp);\r\n                \r\n                this.exp_filled(this.exp_now, event_exp);  //当前经验值数值增长\r\n                \r\n                break;\r\n        \r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n\r\n    onLoad () {\r\n        this.exp_init(); //初始化为exp各项属性值\r\n\r\n    }\r\n\r\n\r\n    start () {  \r\n\r\n        //获取persisit_node中自动保存的经验值\r\n        this.exp_auto_save(cc.find('persist_node').getComponent('persist_node').exp_inf_message());\r\n        \r\n        \r\n        \r\n\r\n        //触摸经验条面板，测试经验条增加\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (event)=>{\r\n            this.exp_gain(0,100);\r\n\r\n        });\r\n        \r\n    }\r\n\r\n     update (dt) {\r\n\r\n\r\n\r\n        //如果经验值满，则可以进入修仙界面\r\n        if(this.exp_now == this.exp_required()){\r\n            this.xiuxian.active=true;\r\n\r\n        }\r\n        else{\r\n            this.xiuxian.active=false;\r\n        }\r\n\r\n\r\n     }\r\n}\r\n"]}