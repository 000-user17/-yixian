{"version":3,"sources":["assets\\script\\scene2\\jinmai.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n/*\r\n该脚本存放在突破场景中，必须要从主场景中切换过来才能正常运行\r\n\r\n*/ \r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class jinmai extends cc.Component {\r\n\r\n    @property\r\n    jinmai_index:number = 0;    //表示不同的筋脉，在cocos面板中调整，使得不同的筋脉节点可以使用同一个脚本\r\n\r\n    attribute:number = 0;      //暂存本节点筋脉对应的人物属性\r\n\r\n\r\n\r\n    @property\r\n    is_click:boolean = false;  //控制筋脉消失前只能点击一次筋脉\r\n\r\n    sort_attr:number[] = [];//获取排序后属性索引的数组\r\n\r\n\r\n    private random1:number = 0; //随机数的产生，产生于start时，用于控制属性对丹田量的影响；丹药撤回操作将重置改随机数，而观察下一个突破经脉的值的丹药，是不会改变该随机数。从而区分不同【丹药】的效果\r\n    \r\n    private random2:number = 0; //第二种情况的随机数，即当前丹田值大于110\r\n\r\n    jinmai_loc:number[] = []; //记录当前筋脉位置\r\n\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.attributes_get();  //预载时就加载获取属性\r\n\r\n    }\r\n\r\n    \r\n\r\n    //获取人物八项属性到数组中\r\n    attributes_get(){  \r\n        let persist = cc.find('persist_node').getComponent('persist_node');\r\n        let att_name = persist.attribute_name; //获取属性名称\r\n\r\n        this.attribute = persist.get_attr(att_name[this.jinmai_index]); //获取对应索引属性名称的属性值\r\n        \r\n    }\r\n\r\n    /**\r\n\t * 生成范围随机数\r\n\t * @Min 最小值\r\n\t * @Max 最大值\r\n     * 给予不同节点相同的脚本，每个节点都会分别执行一次改脚本的start等方法\r\n\t */\r\n\tpublic GetRandomNum(Min, Max):number {\r\n\t\tvar Range = Max - Min;\r\n\t\tvar Rand = Math.random();\r\n\t\treturn (Min + Math.round(Rand * Range));\r\n\t}\r\n\r\n\r\n    jinmai(){\r\n\r\n\r\n        cc.loader.loadRes(\"突破\", cc.AudioClip, (res,clip)=>{\r\n            //播放音乐\r\n            let audioID: number = cc.audioEngine.playEffect(clip, false);\r\n            cc.audioEngine.setVolume(audioID, 0.1);\r\n            //停止播放音乐\r\n            //cc.audioEngine.stop(audioID);\r\n        });\r\n\r\n        \r\n        let att_order = this.sort_attr.indexOf(this.jinmai_index); //获得本属性的排序位置\r\n\r\n        let double_effect = cc.find('danyao2').getComponent('danyao').get_double_effect();  //丹药2的效益为双倍效果，所以检测danyao2下脚本的double_effect组件\r\n        \r\n        let dantian_now = cc.find('dantian').getComponent('dantian').dantian_now;\r\n        //将人物属性值和人物突破该筋脉带来的收益结合\r\n\r\n        let dantian_add = 0;//突破该条筋脉的丹田增加量\r\n        if(dantian_now <= 110){\r\n            dantian_add = (100-att_order*10) + this.random1;\r\n        }\r\n        else{\r\n            dantian_add = (210-dantian_now)+this.random2;\r\n\r\n        }\r\n\r\n\r\n        //用于【丹药2】效果\r\n        if(double_effect){\r\n            dantian_add *= 2;\r\n            cc.find('danyao2').getComponent('danyao').double_effect = false; //只能双倍一次\r\n        }\r\n\r\n\r\n        if(cc.find('danyao4').getComponent('danyao').get_yuce_effect()){  //【丹药4】效果，如果服用丹药，开启了预测效果\r\n\r\n            this.jinmai_tishi('丹田量增加'+String(dantian_add)); //增加的ui显示，只显示，而不进行丹田量的增加\r\n            cc.find('danyao4').getComponent('danyao').set_yuce_effect(false); //只能预测一次，重新设置为负数\r\n            return ; //预测完毕就直接返回，不执行下面的语句了\r\n\r\n        }\r\n\r\n\r\n        let pre_num = cc.find('dantian').getComponent('dantian').explosion + cc.find('dantian').getComponent('dantian').dantian_now;  //操作前丹田和丹田爆炸的数值,【用于丹药3的效果】\r\n\r\n\r\n        cc.find('dantian').getComponent('dantian').dantian_gain(dantian_add);//增加丹田量\r\n\r\n        cc.find('dantian').getComponent('dantian').tupo_num += 1;//突破筋脉，突破筋脉数量+1\r\n\r\n        this.jinmai_tishi('丹田量增加'+String(dantian_add)); //增加的ui显示\r\n\r\n\r\n        cc.find('danyao3').getComponent('danyao').push_chehui_jinmai(this.node.name);//【用于丹药3效果的入栈】入栈突破的筋脉名字\r\n        //【用于丹药3的效果】start\r\n        let change_num = cc.find('dantian').getComponent('dantian').explosion + cc.find('dantian').getComponent('dantian').dantian_now - pre_num; //操作后丹田和丹田超出值的该变量，由于explosion只会再dantian_now满时增加，所以可以将该值放入danyao_3的栈中\r\n        cc.find('danyao3').getComponent('danyao').push_chehui_effect(change_num); \r\n        //另外一个栈的进入操作写在筋脉处\r\n        //【用于丹药3的效果】end\r\n\r\n    }\r\n\r\n    //控制经脉消失\r\n    disappear(){\r\n        let sp = this.node.getComponent(cc.Sprite);\r\n        this.schedule(()=>{          //动态消失\r\n            sp.fillRange -= (1/10)\r\n        }, 1/100, 10);\r\n\r\n    }\r\n\r\n    //控制经脉出现,用于【丹药2】的撤回操作\r\n    appear(){\r\n        //撤回之后重置两种情况的随机数\r\n        this.random1 = this.GetRandomNum(-10,10);\r\n        let att_order = this.sort_attr.indexOf(this.jinmai_index); //获得本属性的排序位置\r\n        this.random2 = this.GetRandomNum((9-att_order)*(-10), (9-att_order)*10);\r\n\r\n        cc.find('dantian').getComponent('dantian').tupo_num -= 1; //撤回筋脉，突破数量减一\r\n\r\n        let sp = this.node.getComponent(cc.Sprite);\r\n        this.schedule(()=>{          //动态出现\r\n            sp.fillRange += (1/10)\r\n        }, 1/100, 10);\r\n    }\r\n\r\n    //点击筋脉的提示效果\r\n    jinmai_tishi(name:string){\r\n        \r\n        let jinmaitupo = new cc.Node();\r\n        var tishi = jinmaitupo.addComponent(cc.Label); //增加label组件并赋给丹药数量\r\n        jinmaitupo.color = cc.color(255,255,255); //将字体改为白色\r\n        //设置文本大小\r\n        tishi.fontSize = 40;\r\n        tishi.lineHeight = 40;\r\n \r\n        jinmaitupo.setParent(this.node);  //父节点是this.node才能出来\r\n        jinmaitupo.x = 0; //相对于父节点的横坐标位置不变\r\n        jinmaitupo.y = 0;//相对于父节点的纵坐标在下面一点的位置\r\n        tishi.string = name;  \r\n\r\n\r\n        this.schedule(()=>{\r\n            jinmaitupo.y += 5;    //增加5和减少0.01都可以增快提示速度\r\n        }, 0.01, 20);\r\n\r\n        //延时最后的时间为ms,延时1秒销毁，如果在上面的schedule函数还没执行完就销毁，会报错\r\n        setTimeout(()=>{\r\n            jinmaitupo.destroy();\r\n        }, 1000);\r\n\r\n\r\n        \r\n    }\r\n\r\n\r\n\r\n    start () {\r\n        this.jinmai_loc = [this.node.x, this.node.y]; //获取筋脉初始位置\r\n        this.sort_attr = cc.find('persist_node').getComponent('persist_node').sort_attr(); //获取排序后属性索引的数组\r\n        let att_order = this.sort_attr.indexOf(this.jinmai_index); //获得本属性的排序位置\r\n\r\n        //根据排序改变颜色\r\n        //this.node.color = cc.color(att_order*20,30,80);\r\n\r\n        this.random1 = this.GetRandomNum(-10,10); //获取-10到10的随机数\r\n        this.random2 = this.GetRandomNum((9-att_order)*(-10), (9-att_order)*10);//获取第二个随机数\r\n\r\n        //只能点击一次静脉\r\n        this.node.on(cc.Node.EventType.TOUCH_START, (event)=>{\r\n\r\n            //【丹药4】的效果，预测完毕直接返回\r\n            if(cc.find('danyao4').getComponent('danyao').get_yuce_effect()){\r\n                this.jinmai();\r\n                return ;\r\n\r\n            }\r\n\r\n            if(!this.is_click){ //确保只能突破一次静脉，即点击一次还没消失时就不能点了\r\n                this.jinmai();\r\n                this.is_click = true; \r\n            }\r\n                \r\n            this.disappear();\r\n                \r\n            });\r\n\r\n        }\r\n\r\n\r\n    move(){\r\n\r\n        let att_order = this.sort_attr.indexOf(this.jinmai_index); //获得本属性的排序位置\r\n\r\n        let random_loc_x = this.GetRandomNum(-1*(9-att_order), 9-att_order);  //排名越靠前的筋脉越不稳定\r\n        let random_loc_y = this.GetRandomNum(-1*(9-att_order),9-att_order);\r\n\r\n        if(this.node.x -this.jinmai_loc[0] < -4){\r\n            random_loc_x = 2;\r\n        }\r\n\r\n        else if(this.node.x -this.jinmai_loc[0] > 4){\r\n            random_loc_x = -2;\r\n        }\r\n        \r\n        if(this.node.y -this.jinmai_loc[1] < -4){\r\n            random_loc_y = 2;\r\n        }\r\n\r\n        else if(this.node.y -this.jinmai_loc[1] > 4){\r\n            random_loc_y = -2;\r\n        }\r\n        \r\n        this.node.x+=random_loc_x;\r\n        this.node.y+=random_loc_y;\r\n\r\n\r\n    }\r\n    update (dt) {\r\n        this.move();\r\n\r\n    }\r\n}\r\n"]}